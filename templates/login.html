<!DOCTYPE html>
<html lang="da">
<head>
  <meta charset="UTF-8">
  <title>Login</title>
  <meta name="viewport" content="width=device-width, initial-scale=1">

  <link rel="icon" type="image/x-icon" href="{{ url_for('static', filename='favicon.ico') }}">
  <link rel="manifest" href="{{ url_for('static', filename='manifest.json') }}">
  <link rel="stylesheet" href="{{ url_for('static', filename='style.css') }}?v=fix1">

  <script>
    if ('serviceWorker' in navigator) {
      navigator.serviceWorker.register('{{ url_for("static", filename="service-worker.js") }}');
    }
  </script>
</head>
<body>

  <!-- TOP -->
  <header class="toppanel toppanel--login" role="banner">
    <div class="top-left">
      <button class="hamburger" id="loginHamburger" type="button"
            aria-controls="loginMenu" aria-expanded="false">
      <span class="hamburger-bar"></span>
      <span class="hamburger-bar"></span>
      <span class="hamburger-bar"></span>
    </button>
  

    <!-- Kun ét loginMenu pr. side -->
    <nav id="loginMenu" class="login-menu" aria-hidden="true" role="menu">
      <a href="/opret"     class="toppanel-knap">Opret ny bruger</a>
      <a href="/skiftkode" class="toppanel-knap">Skift adgangskode</a>
      <a href="/regler"    class="toppanel-knap">Regler</a>
      <a href="/betingelser"   class="toppanel-knap">Brugervilkår</a>
    </nav>
    </div>
      <div class="brand"><a href="/">Vasketider</a></div>
  </header>

  <!-- INDHOLD -->
  <main class="auth-wrap" role="main">
    <div class="auth-box">
      <h2>Log ind</h2>

      {% if fejl %}<p class="msg msg-error" role="alert">{{ fejl }}</p>{% endif %}
      {% if besked %}<p class="msg msg-ok">{{ besked }}</p>{% endif %}

      <form id="loginForm" method="post" action="/login" class="auth-form">
        <input type="text" id="brugernavn" name="brugernavn" placeholder="Brugernavn" required autocomplete="username">
        <input type="password" id="kode" name="kode" placeholder="Adgangskode" required autocomplete="current-password">

        <div class="remember-line">
          <label class="switch" title="Husk brugernavn og (ikke for admin) adgangskode på denne enhed">
            <input type="checkbox" id="huskMig" name="remember" value="1">
            <span class="slider round"></span>
          </label>
          <span class="remember-text">Husk mig</span>
        </div>

        <button type="submit" class="glass-btn">Log ind</button>
      </form>
    </div>
  </main>

  <!-- FOOTER -->
  <footer class="footer">
    <span class="footer-left">Powered by © Hornsberg Group</span>
    <ul class="socials">
      <li>
        <a href="https://linkedin.com" target="_blank"  rel="noopener" aria-label="LinkedIn">
          <span class="icon-wrap">
            <img src="{{ url_for('static', filename='icons/linkedin.svg') }}" alt="LinkedIn">
          </span>
        </a>
      </li>
      <li>
        <a href="https://facebook.com" target="_blank"  rel="noopener" aria-label="Facebook">
          <span class="icon-wrap">
            <img src="{{ url_for('static', filename='icons/facebook.svg') }}" alt="Facebook">
          </span>
        </a>
      </li>
      <li>
        <a href="https://instagram.com" target="_blank"  rel="noopener" aria-label="Instagram">
          <span class="icon-wrap">
            <img src="{{ url_for('static', filename='icons/instagram.svg') }}" alt="Instagram">
          </span>
        </a>
      </li>
    </ul>
  </footer>

  <!-- FÆLLES menu-script: kun én attach -->
  <script>
  (function () {
    function attach(buttonSel, drawerSel) {
      const btn  = document.querySelector(buttonSel);
      const menu = document.querySelector(drawerSel);
      if (!btn || !menu) return;

      const setOpen = (open) => {
        btn.classList.toggle('active', open);
        menu.classList.toggle('show', open);
        btn.setAttribute('aria-expanded', open ? 'true' : 'false');
        menu.setAttribute('aria-hidden', open ? 'false' : 'true');
      };

      if (btn.dataset.bound === '1') return; // undgå dobbelt-binding
      btn.dataset.bound = '1';

      btn.addEventListener('click', (e) => {
        e.stopPropagation();
        setOpen(!menu.classList.contains('show'));
      }, { passive:true });

      document.addEventListener('click', (e) => {
        const inside = btn.contains(e.target) || menu.contains(e.target);
        if (!inside) setOpen(false);
      });

      document.addEventListener('keydown', (e) => {
        if (e.key === 'Escape') setOpen(false);
      });

      setOpen(false);
    }

    function boot(){
      attach('#loginHamburger', '#loginMenu');
      // (index init er ikke nødvendig på login-siden)
    }

    if (document.readyState === 'loading') {
      document.addEventListener('DOMContentLoaded', boot);
    } else {
      boot();
      setTimeout(boot, 50);
    }
  })();
  </script>
</body>
</html>